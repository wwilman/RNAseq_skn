#do budowania indeksu pobieramy CDNA oraz ncRNA
wget ftp://ftp.ensemblgenomes.org/pub/release-46/plants/fasta/arabidopsis_thaliana/ncrna/Arabidopsis_thaliana.TAIR10.ncrna.fa.gz
wget ftp://ftp.ensemblgenomes.org/pub/release-46/plants/fasta/arabidopsis_thaliana/cdna/Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz

#łączymy je w jeden plik
cat Arabidopsis_thaliana.TAIR10.cdna.all.fa.gz Arabidopsis_thaliana.TAIR10.ncrna.fa.gz > Arabidopsis_index

#tworzenie indeksu za pomoca kallisto
kallisto index -i Arabidopsis_index.idx Arabidopsis_index

#Kwantyfikacja ekspresji 
#!/bin/bash  
file="Arabidopsis_index.idx"
inp=""
fr="ERR4131"  

typ=".fastq.gz"  

for n in 950 951 952 953 966 967 968 969

do

mkdir wyniki_kallisto$fr$n/$fr$n

echo "===================================================="  

echo 'Pseudoaligning file: '$n

echo "====================================================" 

kallisto quant  --single --index=Arabidopsis_index.idx --output=wyniki_kallistofr/$ng$nr $inp$fr$n$typ $inp$fr$n$typ

done
